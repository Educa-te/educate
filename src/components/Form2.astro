---
import Container from "./Container.astro";
---

<section id="form" class="">
  <Container>
    <div class="flex bg-[#1F1F1F] text-white rounded-2xl relative">
      <div class="w-[54%] p-4">
        <h2 class="text-4xl ">
          ACCEDE A NUESTRO PRIMER EBOOK DE FORMA GRATUITA
        </h2>
        <h3 class="text-end">Envianos tu solicitud ⭢</h3>
      </div>
      <div class="bg-white text-black w-[36%] shadow-md min-h-96 ">
        <form id="myForm" class="flex flex-col p-4 m-4 border border-[#B9FE6D] rounded h-[80%]">
          <label for="POST-name" ><span class="bg-[#B9FE6D]">Nombre:</span></label>
          <input id="POST-name" type="text" name="name" class="border border-[#B9FE6D] rounded"/>
          
          <label for="POST-email" ><span class="bg-[#B9FE6D]">Correo:</span></label>
          <input id="POST-email" type="text" name="email" class="border border-[#B9FE6D] rounded"/>
          <input type="submit" value="Enviar Solicitud" class="border-[#B9FE6D] border rounded mt-4"/>
        </form>
      </div>
    </div>
  </Container>
</section>

<script>
  document.getElementById('myForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    var formData = {
      name: document.getElementById('POST-name').value,
      email: document.getElementById('POST-email').value,
    };
  
    fetch('https://script.google.com/macros/s/AKfycbxBUQvMQ2my4xLPBZr2UTKCp1LxpxtHgxGeMXdzu1xdb1Eo-J4e7LGHOTn6nhotuzeEWw/exec', {
      method: 'POST',
      body: JSON.stringify(formData),
      headers: {
        'Content-Type': 'application/json'
      }
    })
    .then(response => response.json())
    .then(data => {
      console.log(data);
      if(data.result === "success") {
        alert("Formulario enviado con éxito!");
      } else {
        alert("Hubo un error al enviar el formulario.");
      }
    })
    .catch(error => {
      console.error('Error:', error);
      alert("Hubo un error al enviar el formulario.");
    });
  });
  </script>
